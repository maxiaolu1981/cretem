<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: overall_flow Pages: 1 -->
<svg width="1320pt" height="168pt"
 viewBox="0.00 0.00 1320.00 168.12" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 164.12)">
<title>overall_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-164.12 1316,-164.12 1316,4 -4,4"/>
<!-- client -->
<g id="node1" class="node">
<title>client</title>
<polygon fill="#e8f0ff" stroke="#333333" points="61,-91 0,-91 0,-87 -4,-87 -4,-83 0,-83 0,-61 -4,-61 -4,-57 0,-57 0,-53 61,-53 61,-91"/>
<polyline fill="none" stroke="#333333" points="0,-87 4,-87 4,-83 0,-83 "/>
<polyline fill="none" stroke="#333333" points="0,-61 4,-61 4,-57 0,-57 "/>
<text text-anchor="middle" x="30.5" y="-75.8" font-family="Arial" font-size="14.00">Client</text>
<text text-anchor="middle" x="30.5" y="-60.8" font-family="Arial" font-size="14.00">(HTTP)</text>
</g>
<!-- apiserver -->
<g id="node2" class="node">
<title>apiserver</title>
<polygon fill="#fff0e6" stroke="#333333" points="180,-91 98,-91 98,-87 94,-87 94,-83 98,-83 98,-61 94,-61 94,-57 98,-57 98,-53 180,-53 180,-91"/>
<polyline fill="none" stroke="#333333" points="98,-87 102,-87 102,-83 98,-83 "/>
<polyline fill="none" stroke="#333333" points="98,-61 102,-61 102,-57 98,-57 "/>
<text text-anchor="middle" x="139" y="-75.8" font-family="Arial" font-size="14.00">API Server</text>
<text text-anchor="middle" x="139" y="-60.8" font-family="Arial" font-size="14.00">(Gin)</text>
</g>
<!-- client&#45;&gt;apiserver -->
<g id="edge1" class="edge">
<title>client&#45;&gt;apiserver</title>
<path fill="none" stroke="black" d="M61.17,-72C69.39,-72 78.56,-72 87.62,-72"/>
<polygon fill="black" stroke="black" points="87.75,-75.5 97.75,-72 87.75,-68.5 87.75,-75.5"/>
</g>
<!-- apiserver&#45;&gt;apiserver -->
<g id="edge11" class="edge">
<title>apiserver&#45;&gt;apiserver</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M128.45,-91.04C126.99,-100.53 130.5,-109 139,-109 144.18,-109 147.51,-105.86 148.99,-101.25"/>
<polygon fill="black" stroke="black" points="152.49,-101.22 149.55,-91.04 145.5,-100.83 152.49,-101.22"/>
<text text-anchor="middle" x="139" y="-112" font-family="Times,serif" font-size="10.00">/admin/ratelimit/write (GET/POST/DELETE)</text>
</g>
<!-- write_limiter -->
<g id="node3" class="node">
<title>write_limiter</title>
<polygon fill="#ffe6e6" stroke="#333333" points="519,-91 405,-91 401,-87 401,-53 515,-53 519,-57 519,-91"/>
<polyline fill="none" stroke="#333333" points="515,-87 401,-87 "/>
<polyline fill="none" stroke="#333333" points="515,-87 515,-53 "/>
<polyline fill="none" stroke="#333333" points="515,-87 519,-91 "/>
<text text-anchor="middle" x="460" y="-75.8" font-family="Arial" font-size="14.00">WriteRateLimiter</text>
<text text-anchor="middle" x="460" y="-60.8" font-family="Arial" font-size="14.00">(local + Redis)</text>
</g>
<!-- apiserver&#45;&gt;write_limiter -->
<g id="edge2" class="edge">
<title>apiserver&#45;&gt;write_limiter</title>
<path fill="none" stroke="black" d="M180.25,-72.78C186.2,-72.87 192.26,-72.95 198,-73 280.22,-73.71 300.78,-73.54 383,-73 385.54,-72.98 388.13,-72.96 390.74,-72.94"/>
<polygon fill="black" stroke="black" points="390.94,-76.44 400.91,-72.84 390.88,-69.44 390.94,-76.44"/>
</g>
<!-- apiserver&#45;&gt;write_limiter -->
<g id="edge10" class="edge">
<title>apiserver&#45;&gt;write_limiter</title>
<path fill="none" stroke="#000000" stroke-width="2" d="M180.2,-57.83C186.1,-56.24 192.16,-54.88 198,-54 279.29,-41.68 301.33,-44.46 383,-54 385.53,-54.3 388.11,-54.65 390.7,-55.04"/>
<polygon fill="#000000" stroke="#000000" stroke-width="2" points="390.29,-58.52 400.74,-56.76 391.47,-51.62 390.29,-58.52"/>
<text text-anchor="middle" x="290.5" y="-57.8" font-family="Times,serif" font-size="14.00">reads override key (redis)</text>
</g>
<!-- producer -->
<g id="node4" class="node">
<title>producer</title>
<polygon fill="#e6fff2" stroke="#333333" points="633,-91 556,-91 556,-87 552,-87 552,-83 556,-83 556,-61 552,-61 552,-57 556,-57 556,-53 633,-53 633,-91"/>
<polyline fill="none" stroke="#333333" points="556,-87 560,-87 560,-83 556,-83 "/>
<polyline fill="none" stroke="#333333" points="556,-61 560,-61 560,-57 556,-57 "/>
<text text-anchor="middle" x="594.5" y="-75.8" font-family="Arial" font-size="14.00">Producer</text>
<text text-anchor="middle" x="594.5" y="-60.8" font-family="Arial" font-size="14.00">(kafka&#45;go)</text>
</g>
<!-- write_limiter&#45;&gt;producer -->
<g id="edge3" class="edge">
<title>write_limiter&#45;&gt;producer</title>
<path fill="none" stroke="black" d="M519.12,-72C527.92,-72 536.91,-72 545.46,-72"/>
<polygon fill="black" stroke="black" points="545.64,-75.5 555.64,-72 545.64,-68.5 545.64,-75.5"/>
</g>
<!-- kafka -->
<g id="node5" class="node">
<title>kafka</title>
<path fill="#fff7e6" stroke="#333333" d="M918,-155.48C918,-158.11 896.04,-160.25 869,-160.25 841.96,-160.25 820,-158.11 820,-155.48 820,-155.48 820,-112.52 820,-112.52 820,-109.89 841.96,-107.75 869,-107.75 896.04,-107.75 918,-109.89 918,-112.52 918,-112.52 918,-155.48 918,-155.48"/>
<path fill="none" stroke="#333333" d="M918,-155.48C918,-152.84 896.04,-150.7 869,-150.7 841.96,-150.7 820,-152.84 820,-155.48"/>
<text text-anchor="middle" x="869" y="-137.8" font-family="Arial" font-size="14.00">Kafka Cluster</text>
<text text-anchor="middle" x="869" y="-122.8" font-family="Arial" font-size="14.00">(topics)</text>
</g>
<!-- producer&#45;&gt;kafka -->
<g id="edge4" class="edge">
<title>producer&#45;&gt;kafka</title>
<path fill="none" stroke="black" d="M633.21,-85.67C639.12,-87.59 645.2,-89.44 651,-91 704.16,-105.3 765.82,-117.06 809.79,-124.65"/>
<polygon fill="black" stroke="black" points="809.29,-128.12 819.74,-126.35 810.47,-121.22 809.29,-128.12"/>
</g>
<!-- retry -->
<g id="node8" class="node">
<title>retry</title>
<polygon fill="#fffbe6" stroke="#333333" points="911,-90 908,-94 887,-94 884,-90 827,-90 827,-54 911,-54 911,-90"/>
<text text-anchor="middle" x="869" y="-68.3" font-family="Arial" font-size="14.00">Retry Topic</text>
</g>
<!-- producer&#45;&gt;retry -->
<g id="edge7" class="edge">
<title>producer&#45;&gt;retry</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M633.1,-72C680.74,-72 763.04,-72 816.49,-72"/>
<polygon fill="black" stroke="black" points="816.78,-75.5 826.78,-72 816.78,-68.5 816.78,-75.5"/>
<text text-anchor="middle" x="726.5" y="-75.8" font-family="Times,serif" font-size="14.00">on transient failure</text>
</g>
<!-- dead -->
<g id="node9" class="node">
<title>dead</title>
<polygon fill="#fff0f0" stroke="#333333" points="904.5,-36 827.5,-36 827.5,0 910.5,0 910.5,-30 904.5,-36"/>
<polyline fill="none" stroke="#333333" points="904.5,-36 904.5,-30 "/>
<polyline fill="none" stroke="#333333" points="910.5,-30 904.5,-30 "/>
<text text-anchor="middle" x="869" y="-14.3" font-family="Arial" font-size="14.00">Dead&#45;letter</text>
</g>
<!-- producer&#45;&gt;dead -->
<g id="edge8" class="edge">
<title>producer&#45;&gt;dead</title>
<path fill="none" stroke="#aa0000" stroke-dasharray="1,5" d="M633.16,-58.15C639.08,-56.25 645.17,-54.46 651,-53 707.16,-38.97 772.95,-29.28 817.24,-23.71"/>
<polygon fill="#aa0000" stroke="#aa0000" points="817.69,-27.18 827.19,-22.48 816.84,-20.23 817.69,-27.18"/>
<text text-anchor="middle" x="726.5" y="-56.8" font-family="Times,serif" font-size="14.00">on permanent failure</text>
</g>
<!-- consumer -->
<g id="node6" class="node">
<title>consumer</title>
<polygon fill="#e6f2ff" stroke="#333333" points="1201,-122 1065,-122 1065,-118 1061,-118 1061,-114 1065,-114 1065,-92 1061,-92 1061,-88 1065,-88 1065,-84 1201,-84 1201,-122"/>
<polyline fill="none" stroke="#333333" points="1065,-118 1069,-118 1069,-114 1065,-114 "/>
<polyline fill="none" stroke="#333333" points="1065,-92 1069,-92 1069,-88 1065,-88 "/>
<text text-anchor="middle" x="1133" y="-106.8" font-family="Arial" font-size="14.00">Consumer</text>
<text text-anchor="middle" x="1133" y="-91.8" font-family="Arial" font-size="14.00">(worker pool, batch)</text>
</g>
<!-- kafka&#45;&gt;consumer -->
<g id="edge5" class="edge">
<title>kafka&#45;&gt;consumer</title>
<path fill="none" stroke="black" d="M918.05,-128.31C956.16,-123.81 1010.16,-117.42 1054.38,-112.18"/>
<polygon fill="black" stroke="black" points="1055,-115.64 1064.52,-110.98 1054.18,-108.68 1055,-115.64"/>
</g>
<!-- db -->
<g id="node7" class="node">
<title>db</title>
<path fill="#f0e6ff" stroke="#333333" d="M1312,-124.48C1312,-127.11 1295.42,-129.25 1275,-129.25 1254.58,-129.25 1238,-127.11 1238,-124.48 1238,-124.48 1238,-81.52 1238,-81.52 1238,-78.89 1254.58,-76.75 1275,-76.75 1295.42,-76.75 1312,-78.89 1312,-81.52 1312,-81.52 1312,-124.48 1312,-124.48"/>
<path fill="none" stroke="#333333" d="M1312,-124.48C1312,-121.84 1295.42,-119.7 1275,-119.7 1254.58,-119.7 1238,-121.84 1238,-124.48"/>
<text text-anchor="middle" x="1275" y="-106.8" font-family="Arial" font-size="14.00">Database</text>
<text text-anchor="middle" x="1275" y="-91.8" font-family="Arial" font-size="14.00">(GORM)</text>
</g>
<!-- consumer&#45;&gt;db -->
<g id="edge6" class="edge">
<title>consumer&#45;&gt;db</title>
<path fill="none" stroke="black" d="M1201.13,-103C1210.11,-103 1219.15,-103 1227.67,-103"/>
<polygon fill="black" stroke="black" points="1227.75,-106.5 1237.75,-103 1227.75,-99.5 1227.75,-106.5"/>
</g>
<!-- retry&#45;&gt;consumer -->
<g id="edge9" class="edge">
<title>retry&#45;&gt;consumer</title>
<path fill="none" stroke="black" d="M911.23,-76.88C949.56,-81.41 1007.64,-88.29 1054.62,-93.84"/>
<polygon fill="black" stroke="black" points="1054.42,-97.35 1064.76,-95.04 1055.24,-90.39 1054.42,-97.35"/>
<text text-anchor="middle" x="991.5" y="-96.8" font-family="Times,serif" font-size="14.00">retry consumer</text>
</g>
</g>
</svg>

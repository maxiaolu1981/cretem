<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: pc_flow Pages: 1 -->
<svg width="395pt" height="611pt"
 viewBox="0.00 0.00 395.00 611.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 607.25)">
<title>pc_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-607.25 391,-607.25 391,4 -4,4"/>
<!-- handler -->
<g id="node1" class="node">
<title>handler</title>
<path fill="none" stroke="#000000" d="M261.5,-603.25C261.5,-603.25 182.5,-603.25 182.5,-603.25 176.5,-603.25 170.5,-597.25 170.5,-591.25 170.5,-591.25 170.5,-577.25 170.5,-577.25 170.5,-571.25 176.5,-565.25 182.5,-565.25 182.5,-565.25 261.5,-565.25 261.5,-565.25 267.5,-565.25 273.5,-571.25 273.5,-577.25 273.5,-577.25 273.5,-591.25 273.5,-591.25 273.5,-597.25 267.5,-603.25 261.5,-603.25"/>
<text text-anchor="middle" x="222" y="-588.05" font-family="Arial" font-size="14.00">HTTP Handler</text>
<text text-anchor="middle" x="222" y="-573.05" font-family="Arial" font-size="14.00">(validate/auth)</text>
</g>
<!-- limiter -->
<g id="node2" class="node">
<title>limiter</title>
<path fill="none" stroke="#000000" d="M269,-528.25C269,-528.25 175,-528.25 175,-528.25 169,-528.25 163,-522.25 163,-516.25 163,-516.25 163,-502.25 163,-502.25 163,-496.25 169,-490.25 175,-490.25 175,-490.25 269,-490.25 269,-490.25 275,-490.25 281,-496.25 281,-502.25 281,-502.25 281,-516.25 281,-516.25 281,-522.25 275,-528.25 269,-528.25"/>
<text text-anchor="middle" x="222" y="-513.05" font-family="Arial" font-size="14.00">WriteRateLimiter</text>
<text text-anchor="middle" x="222" y="-498.05" font-family="Arial" font-size="14.00">(local/redis)</text>
</g>
<!-- handler&#45;&gt;limiter -->
<g id="edge1" class="edge">
<title>handler&#45;&gt;limiter</title>
<path fill="none" stroke="black" d="M222,-565.21C222,-557.13 222,-547.43 222,-538.43"/>
<polygon fill="black" stroke="black" points="225.5,-538.34 222,-528.34 218.5,-538.34 225.5,-538.34"/>
</g>
<!-- producer -->
<g id="node3" class="node">
<title>producer</title>
<path fill="none" stroke="#000000" d="M280.5,-453.25C280.5,-453.25 163.5,-453.25 163.5,-453.25 157.5,-453.25 151.5,-447.25 151.5,-441.25 151.5,-441.25 151.5,-427.25 151.5,-427.25 151.5,-421.25 157.5,-415.25 163.5,-415.25 163.5,-415.25 280.5,-415.25 280.5,-415.25 286.5,-415.25 292.5,-421.25 292.5,-427.25 292.5,-427.25 292.5,-441.25 292.5,-441.25 292.5,-447.25 286.5,-453.25 280.5,-453.25"/>
<text text-anchor="middle" x="222" y="-438.05" font-family="Arial" font-size="14.00">Producer</text>
<text text-anchor="middle" x="222" y="-423.05" font-family="Arial" font-size="14.00">(in&#45;flight semaphore)</text>
</g>
<!-- limiter&#45;&gt;producer -->
<g id="edge2" class="edge">
<title>limiter&#45;&gt;producer</title>
<path fill="none" stroke="black" d="M222,-490.21C222,-482.13 222,-472.43 222,-463.43"/>
<polygon fill="black" stroke="black" points="225.5,-463.34 222,-453.34 218.5,-463.34 225.5,-463.34"/>
</g>
<!-- kafka -->
<g id="node4" class="node">
<title>kafka</title>
<path fill="none" stroke="#000000" d="M177,-359.6C177,-362.24 139.8,-364.38 94,-364.38 48.2,-364.38 11,-362.24 11,-359.6 11,-359.6 11,-316.65 11,-316.65 11,-314.01 48.2,-311.87 94,-311.87 139.8,-311.87 177,-314.01 177,-316.65 177,-316.65 177,-359.6 177,-359.6"/>
<path fill="none" stroke="#000000" d="M177,-359.6C177,-356.97 139.8,-354.83 94,-354.83 48.2,-354.83 11,-356.97 11,-359.6"/>
<text text-anchor="middle" x="94" y="-341.93" font-family="Arial" font-size="14.00">Kafka Topic</text>
<text text-anchor="middle" x="94" y="-326.93" font-family="Arial" font-size="14.00">(UserCreate/UserDelete)</text>
</g>
<!-- producer&#45;&gt;kafka -->
<g id="edge3" class="edge">
<title>producer&#45;&gt;kafka</title>
<path fill="none" stroke="black" d="M197.32,-415.1C180.08,-402.42 156.63,-385.18 136.42,-370.32"/>
<polygon fill="black" stroke="black" points="138.41,-367.44 128.28,-364.33 134.26,-373.08 138.41,-367.44"/>
</g>
<!-- retry -->
<g id="node9" class="node">
<title>retry</title>
<path fill="none" stroke="#000000" d="M237,-356.12C237,-356.12 207,-356.12 207,-356.12 201,-356.12 195,-350.12 195,-344.12 195,-344.12 195,-332.12 195,-332.12 195,-326.12 201,-320.12 207,-320.12 207,-320.12 237,-320.12 237,-320.12 243,-320.12 249,-326.12 249,-332.12 249,-332.12 249,-344.12 249,-344.12 249,-350.12 243,-356.12 237,-356.12"/>
<text text-anchor="middle" x="222" y="-334.43" font-family="Arial" font-size="14.00">retry</text>
</g>
<!-- producer&#45;&gt;retry -->
<g id="edge9" class="edge">
<title>producer&#45;&gt;retry</title>
<path fill="none" stroke="#aa7700" stroke-dasharray="5,2" d="M222,-415.1C222,-401.3 222,-382.08 222,-366.42"/>
<polygon fill="#aa7700" stroke="#aa7700" points="225.5,-366.27 222,-356.27 218.5,-366.27 225.5,-366.27"/>
<text text-anchor="middle" x="260" y="-386.05" font-family="Times,serif" font-size="14.00">retry topic</text>
</g>
<!-- dead -->
<g id="node10" class="node">
<title>dead</title>
<path fill="none" stroke="#000000" d="M336,-356.12C336,-356.12 306,-356.12 306,-356.12 300,-356.12 294,-350.12 294,-344.12 294,-344.12 294,-332.12 294,-332.12 294,-326.12 300,-320.12 306,-320.12 306,-320.12 336,-320.12 336,-320.12 342,-320.12 348,-326.12 348,-332.12 348,-332.12 348,-344.12 348,-344.12 348,-350.12 342,-356.12 336,-356.12"/>
<text text-anchor="middle" x="321" y="-334.43" font-family="Arial" font-size="14.00">dead</text>
</g>
<!-- producer&#45;&gt;dead -->
<g id="edge10" class="edge">
<title>producer&#45;&gt;dead</title>
<path fill="none" stroke="#aa0000" stroke-dasharray="1,5" d="M274.95,-415.21C283.8,-410.42 292.28,-404.5 299,-397.25 307.01,-388.62 312.18,-376.78 315.49,-366.04"/>
<polygon fill="#aa0000" stroke="#aa0000" points="318.91,-366.79 318.12,-356.22 312.15,-364.98 318.91,-366.79"/>
<text text-anchor="middle" x="347.5" y="-386.05" font-family="Times,serif" font-size="14.00">dead&#45;letter</text>
</g>
<!-- fetcher -->
<g id="node5" class="node">
<title>fetcher</title>
<path fill="none" stroke="#000000" d="M127,-275C127,-275 61,-275 61,-275 55,-275 49,-269 49,-263 49,-263 49,-249 49,-249 49,-243 55,-237 61,-237 61,-237 127,-237 127,-237 133,-237 139,-243 139,-249 139,-249 139,-263 139,-263 139,-269 133,-275 127,-275"/>
<text text-anchor="middle" x="94" y="-259.8" font-family="Arial" font-size="14.00">Fetcher</text>
<text text-anchor="middle" x="94" y="-244.8" font-family="Arial" font-size="14.00">(single loop)</text>
</g>
<!-- kafka&#45;&gt;fetcher -->
<g id="edge4" class="edge">
<title>kafka&#45;&gt;fetcher</title>
<path fill="none" stroke="black" d="M94,-311.77C94,-303.3 94,-293.8 94,-285.13"/>
<polygon fill="black" stroke="black" points="97.5,-285.08 94,-275.08 90.5,-285.08 97.5,-285.08"/>
</g>
<!-- worker_pool -->
<g id="node6" class="node">
<title>worker_pool</title>
<path fill="none" stroke="#000000" d="M127.5,-186C127.5,-186 60.5,-186 60.5,-186 54.5,-186 48.5,-180 48.5,-174 48.5,-174 48.5,-160 48.5,-160 48.5,-154 54.5,-148 60.5,-148 60.5,-148 127.5,-148 127.5,-148 133.5,-148 139.5,-154 139.5,-160 139.5,-160 139.5,-174 139.5,-174 139.5,-180 133.5,-186 127.5,-186"/>
<text text-anchor="middle" x="94" y="-170.8" font-family="Arial" font-size="14.00">Worker Pool</text>
<text text-anchor="middle" x="94" y="-155.8" font-family="Arial" font-size="14.00">(N workers)</text>
</g>
<!-- fetcher&#45;&gt;worker_pool -->
<g id="edge5" class="edge">
<title>fetcher&#45;&gt;worker_pool</title>
<path fill="none" stroke="black" d="M92.79,-236.69C92.46,-231.03 92.16,-224.76 92,-219 91.8,-211.74 91.93,-203.9 92.2,-196.6"/>
<polygon fill="black" stroke="black" points="95.71,-196.56 92.68,-186.41 88.72,-196.23 95.71,-196.56"/>
</g>
<!-- worker_pool&#45;&gt;fetcher -->
<g id="edge8" class="edge">
<title>worker_pool&#45;&gt;fetcher</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M94,-186C94,-197.78 94,-213.41 94,-226.82"/>
<polygon fill="black" stroke="black" points="90.5,-226.97 94,-236.97 97.5,-226.97 90.5,-226.97"/>
<text text-anchor="middle" x="143" y="-207.8" font-family="Times,serif" font-size="14.00">commit offset</text>
</g>
<!-- batch -->
<g id="node7" class="node">
<title>batch</title>
<path fill="none" stroke="#000000" d="M176,-111C176,-111 12,-111 12,-111 6,-111 0,-105 0,-99 0,-99 0,-85 0,-85 0,-79 6,-73 12,-73 12,-73 176,-73 176,-73 182,-73 188,-79 188,-85 188,-85 188,-99 188,-99 188,-105 182,-111 176,-111"/>
<text text-anchor="middle" x="94" y="-95.8" font-family="Arial" font-size="14.00">Batcher</text>
<text text-anchor="middle" x="94" y="-80.8" font-family="Arial" font-size="14.00">(MaxDBBatchSize / timeout)</text>
</g>
<!-- worker_pool&#45;&gt;batch -->
<g id="edge6" class="edge">
<title>worker_pool&#45;&gt;batch</title>
<path fill="none" stroke="black" d="M94,-147.96C94,-139.88 94,-130.18 94,-121.18"/>
<polygon fill="black" stroke="black" points="97.5,-121.09 94,-111.09 90.5,-121.09 97.5,-121.09"/>
</g>
<!-- db -->
<g id="node8" class="node">
<title>db</title>
<path fill="none" stroke="#000000" d="M140,-32.73C140,-34.53 119.38,-36 94,-36 68.62,-36 48,-34.53 48,-32.73 48,-32.73 48,-3.27 48,-3.27 48,-1.47 68.62,0 94,0 119.38,0 140,-1.47 140,-3.27 140,-3.27 140,-32.73 140,-32.73"/>
<path fill="none" stroke="#000000" d="M140,-32.73C140,-30.92 119.38,-29.45 94,-29.45 68.62,-29.45 48,-30.92 48,-32.73"/>
<text text-anchor="middle" x="94" y="-14.3" font-family="Arial" font-size="14.00">DB (GORM)</text>
</g>
<!-- batch&#45;&gt;db -->
<g id="edge7" class="edge">
<title>batch&#45;&gt;db</title>
<path fill="none" stroke="black" d="M94,-72.83C94,-64.89 94,-55.41 94,-46.63"/>
<polygon fill="black" stroke="black" points="97.5,-46.42 94,-36.42 90.5,-46.42 97.5,-46.42"/>
</g>
</g>
</svg>

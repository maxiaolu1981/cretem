<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: db_flow Pages: 1 -->
<svg width="727pt" height="332pt"
 viewBox="0.00 0.00 727.00 332.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 328.25)">
<title>db_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-328.25 723,-328.25 723,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_db</title>
<path fill="none" stroke="black" d="M33,-81C33,-81 543,-81 543,-81 549,-81 555,-87 555,-93 555,-93 555,-235.25 555,-235.25 555,-241.25 549,-247.25 543,-247.25 543,-247.25 33,-247.25 33,-247.25 27,-247.25 21,-241.25 21,-235.25 21,-235.25 21,-93 21,-93 21,-87 27,-81 33,-81"/>
<text text-anchor="middle" x="288" y="-232.05" font-family="Arial" font-size="14.00">Database / Persistence</text>
</g>
<!-- db -->
<g id="node1" class="node">
<title>db</title>
<path fill="#f0e6ff" stroke="#5a67d8" d="M133,-136.6C133,-139.24 109.69,-141.38 81,-141.38 52.31,-141.38 29,-139.24 29,-136.6 29,-136.6 29,-93.65 29,-93.65 29,-91.01 52.31,-88.87 81,-88.87 109.69,-88.87 133,-91.01 133,-93.65 133,-93.65 133,-136.6 133,-136.6"/>
<path fill="none" stroke="#5a67d8" d="M133,-136.6C133,-133.97 109.69,-131.83 81,-131.83 52.31,-131.83 29,-133.97 29,-136.6"/>
<text text-anchor="middle" x="81" y="-118.92" font-family="Arial" font-size="14.00">DB</text>
<text text-anchor="middle" x="81" y="-103.92" font-family="Arial" font-size="14.00">(事务/索引/锁)</text>
</g>
<!-- note1 -->
<g id="node7" class="node">
<title>note1</title>
<polygon fill="none" stroke="black" points="156,-52 0,-52 0,0 162,0 162,-46 156,-52"/>
<polyline fill="none" stroke="black" points="156,-52 156,-46 "/>
<polyline fill="none" stroke="black" points="162,-46 156,-46 "/>
<text text-anchor="middle" x="81" y="-40" font-family="Arial" font-size="10.00">Best practices:</text>
<text text-anchor="middle" x="81" y="-29" font-family="Arial" font-size="10.00">&#45; Use batched transactions</text>
<text text-anchor="middle" x="81" y="-18" font-family="Arial" font-size="10.00">&#45; Monitor 95/99 latency</text>
<text text-anchor="middle" x="81" y="-7" font-family="Arial" font-size="10.00">&#45; Keep indexes minimal for writes</text>
</g>
<!-- db&#45;&gt;note1 -->
<g id="edge6" class="edge">
<title>db&#45;&gt;note1</title>
<path fill="none" stroke="#4a5568" stroke-dasharray="5,2" d="M81,-88.92C81,-77.37 81,-63.7 81,-52.14"/>
</g>
<!-- tx -->
<g id="node2" class="node">
<title>tx</title>
<polygon fill="#edf2f7" stroke="black" points="357,-216.25 217,-216.25 217,-178.25 357,-178.25 357,-216.25"/>
<text text-anchor="middle" x="287" y="-201.05" font-family="Arial" font-size="14.00">Transactional Writes</text>
<text text-anchor="middle" x="287" y="-186.05" font-family="Arial" font-size="14.00">(commit/rollback)</text>
</g>
<!-- tx&#45;&gt;db -->
<g id="edge2" class="edge">
<title>tx&#45;&gt;db</title>
<path fill="none" stroke="black" d="M238.91,-178.16C210.88,-167.54 174.88,-153.79 143,-141.25 142.8,-141.17 142.59,-141.09 142.39,-141.01"/>
<polygon fill="black" stroke="black" points="143.65,-137.74 133.06,-137.31 141.07,-144.25 143.65,-137.74"/>
</g>
<!-- idx -->
<g id="node3" class="node">
<title>idx</title>
<polygon fill="#fff7e6" stroke="black" points="258.5,-134.12 151.5,-134.12 151.5,-96.12 264.5,-96.12 264.5,-128.12 258.5,-134.12"/>
<polyline fill="none" stroke="black" points="258.5,-134.12 258.5,-128.12 "/>
<polyline fill="none" stroke="black" points="264.5,-128.12 258.5,-128.12 "/>
<text text-anchor="middle" x="208" y="-118.92" font-family="Arial" font-size="14.00">Indexes</text>
<text text-anchor="middle" x="208" y="-103.92" font-family="Arial" font-size="14.00">(read/write cost)</text>
</g>
<!-- tx&#45;&gt;idx -->
<g id="edge3" class="edge">
<title>tx&#45;&gt;idx</title>
<path fill="none" stroke="#4a5568" stroke-dasharray="5,2" d="M269.07,-178.07C258.47,-167.31 244.87,-153.52 233.2,-141.68"/>
<polygon fill="#4a5568" stroke="#4a5568" points="235.37,-138.9 225.86,-134.23 230.38,-143.81 235.37,-138.9"/>
</g>
<!-- slowq -->
<g id="node4" class="node">
<title>slowq</title>
<polygon fill="none" stroke="#c53030" points="415,-133.12 282.78,-115.13 415,-97.12 547.22,-115.12 415,-133.12"/>
<text text-anchor="middle" x="415" y="-111.42" font-family="Arial" font-size="14.00">Slow Queries / Locks</text>
</g>
<!-- tx&#45;&gt;slowq -->
<g id="edge4" class="edge">
<title>tx&#45;&gt;slowq</title>
<path fill="none" stroke="#c53030" stroke-dasharray="1,5" d="M316.05,-178.07C336.22,-165.44 363.08,-148.63 383.73,-135.7"/>
<polygon fill="#c53030" stroke="#c53030" points="385.82,-138.52 392.44,-130.25 382.11,-132.59 385.82,-138.52"/>
</g>
<!-- app -->
<g id="node5" class="node">
<title>app</title>
<polygon fill="#e6f2ff" stroke="black" points="557,-324.25 399,-324.25 399,-288.25 557,-288.25 557,-324.25"/>
<text text-anchor="middle" x="478" y="-302.55" font-family="Arial" font-size="14.00">Consumer Batch Writer</text>
</g>
<!-- app&#45;&gt;tx -->
<g id="edge1" class="edge">
<title>app&#45;&gt;tx</title>
<path fill="none" stroke="black" d="M447.31,-288.06C414.94,-269.92 363.76,-241.25 327.96,-221.19"/>
<polygon fill="black" stroke="black" points="329.64,-218.13 319.21,-216.29 326.22,-224.23 329.64,-218.13"/>
</g>
<!-- cache -->
<g id="node6" class="node">
<title>cache</title>
<polygon fill="#fffbe6" stroke="black" points="719,-216.25 563,-216.25 563,-212.25 559,-212.25 559,-208.25 563,-208.25 563,-186.25 559,-186.25 559,-182.25 563,-182.25 563,-178.25 719,-178.25 719,-216.25"/>
<polyline fill="none" stroke="black" points="563,-212.25 567,-212.25 567,-208.25 563,-208.25 "/>
<polyline fill="none" stroke="black" points="563,-186.25 567,-186.25 567,-182.25 563,-182.25 "/>
<text text-anchor="middle" x="641" y="-201.05" font-family="Arial" font-size="14.00">Cache (optional)</text>
<text text-anchor="middle" x="641" y="-186.05" font-family="Arial" font-size="14.00">invalidate/write&#45;through</text>
</g>
<!-- app&#45;&gt;cache -->
<g id="edge5" class="edge">
<title>app&#45;&gt;cache</title>
<path fill="none" stroke="#4a5568" stroke-dasharray="5,2" d="M504.19,-288.06C531.46,-270.15 574.39,-241.98 604.88,-221.96"/>
<polygon fill="#4a5568" stroke="#4a5568" points="607.08,-224.71 613.51,-216.29 603.23,-218.85 607.08,-224.71"/>
<text text-anchor="middle" x="611.5" y="-259.05" font-family="Times,serif" font-size="14.00">update/invalidate</text>
</g>
</g>
</svg>

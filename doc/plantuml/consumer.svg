<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1101px" preserveAspectRatio="none" style="width:2750px;height:1101px;background:#FFFFFF;" version="1.1" viewBox="0 0 2750 1101" width="2750px" zoomAndPan="magnify"><title>Consumer fetcher -&gt; worker -&gt; batch -&gt; DB -&gt; commit (cdmp-mini)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="531.1523" x="1113.3062" y="27.9951">Consumer fetcher -&gt; worker -&gt; batch -&gt; DB -&gt; commit (cdmp-mini)</text><rect fill="none" height="248.8672" style="stroke:#000000;stroke-width:1.5;" width="894.2891" x="1026.6982" y="300.2578"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1585.0059" x="611.375" y="679.6563"/><g><title>Kafka</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="584.6875" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="588" x2="588" y1="118.5938" y2="1020.3203"/></g><g><title>Fetcher .StartConsuming.</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="715.0435" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="718.375" x2="718.375" y1="118.5938" y2="1020.3203"/></g><g><title>Job Channel .jobs.</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="904.6665" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="907.9077" x2="907.9077" y1="118.5938" y2="1020.3203"/></g><g><title>Worker Pool</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="1081.9751" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1085.6982" x2="1085.6982" y1="118.5938" y2="1020.3203"/></g><g><title>Batch Goroutine .batchCh.</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="1441.5059" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1444.6484" x2="1444.6484" y1="118.5938" y2="1020.3203"/></g><g><title>DB .GORM.</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="1860.2705" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1863.5537" x2="1863.5537" y1="118.5938" y2="1020.3203"/></g><g><title>Consumer.commitWithRetry</title><rect fill="#000000" fill-opacity="0.00000" height="901.7266" width="8" x="2023.3477" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2026.9873" x2="2026.9873" y1="118.5938" y2="1020.3203"/></g><g class="participant participant-head" data-participant="Kafka"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.375" x="566" y="115.292">Kafka</text><ellipse cx="588.6875" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M588.6875,58.7969 L588.6875,85.7969 M575.6875,66.7969 L601.6875,66.7969 M588.6875,85.7969 L575.6875,100.7969 M588.6875,85.7969 L601.6875,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Kafka"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.375" x="566" y="1032.3154">Kafka</text><ellipse cx="588.6875" cy="1044.1172" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M588.6875,1052.1172 L588.6875,1079.1172 M575.6875,1060.1172 L601.6875,1060.1172 M588.6875,1079.1172 L575.6875,1094.1172 M588.6875,1079.1172 L601.6875,1094.1172" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Fetcher"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195.3369" x="621.375" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.3369" x="628.375" y="107.292">Fetcher (StartConsuming)</text></g><g class="participant participant-tail" data-participant="Fetcher"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195.3369" x="621.375" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181.3369" x="628.375" y="1039.3154">Fetcher (StartConsuming)</text></g><g class="participant participant-head" data-participant="Jobs"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141.5176" x="837.9077" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.5176" x="844.9077" y="107.292">Job Channel (jobs)</text></g><g class="participant participant-tail" data-participant="Jobs"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141.5176" x="837.9077" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.5176" x="844.9077" y="1039.3154">Job Channel (jobs)</text></g><g class="participant participant-head" data-participant="Worker"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98.5537" x="1036.6982" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.5537" x="1043.6982" y="107.292">Worker Pool</text></g><g class="participant participant-tail" data-participant="Worker"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98.5537" x="1036.6982" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.5537" x="1043.6982" y="1039.3154">Worker Pool</text></g><g class="participant participant-head" data-participant="Batch"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.7148" x="1344.6484" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.7148" x="1351.6484" y="107.292">Batch Goroutine (batchCh)</text></g><g class="participant participant-tail" data-participant="Batch"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.7148" x="1344.6484" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.7148" x="1351.6484" y="1039.3154">Batch Goroutine (batchCh)</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93.4336" x="1817.5537" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.4336" x="1824.5537" y="107.292">DB (GORM)</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93.4336" x="1817.5537" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.4336" x="1824.5537" y="1039.3154">DB (GORM)</text></g><g class="participant participant-head" data-participant="Commit"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="212.7207" x="1920.9873" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198.7207" x="1927.9873" y="107.292">Consumer.commitWithRetry</text></g><g class="participant participant-tail" data-participant="Commit"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="212.7207" x="1920.9873" y="1019.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198.7207" x="1927.9873" y="1039.3154">Consumer.commitWithRetry</text></g><g class="message" data-participant-1="Kafka" data-participant-2="Fetcher"><polygon fill="#181818" points="707.0435,145.7266,717.0435,149.7266,707.0435,153.7266,711.0435,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="588.6875" x2="713.0435" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.0796" x="595.6875" y="144.6606">FetchMessage()</text></g><g class="message" data-participant-1="Fetcher" data-participant-2="Jobs"><polygon fill="#181818" points="896.6665,174.8594,906.6665,178.8594,896.6665,182.8594,900.6665,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="719.0435" x2="902.6665" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.4395" x="726.0435" y="173.7935">create job{msg, done}</text></g><path d="M724,191.8594 L724,216.8594 L897,216.8594 L897,201.8594 L887,191.8594 L724,191.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M887,191.8594 L887,201.8594 L897,201.8594 L887,191.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.6992" x="730" y="208.9263">Round-robin to workers</text><g class="message" data-participant-1="Jobs" data-participant-2="Worker"><polygon fill="#181818" points="1073.9751,239.125,1083.9751,243.125,1073.9751,247.125,1077.9751,243.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.6665" x2="1079.9751" y1="243.125" y2="243.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1963" x="915.6665" y="238.0591">worker picks job</text></g><g class="message" data-participant-1="Worker" data-participant-2="Worker"><line style="stroke:#181818;stroke-width:1;" x1="1085.9751" x2="1127.9751" y1="272.2578" y2="272.2578"/><line style="stroke:#181818;stroke-width:1;" x1="1127.9751" x2="1127.9751" y1="272.2578" y2="285.2578"/><line style="stroke:#181818;stroke-width:1;" x1="1086.9751" x2="1127.9751" y1="285.2578" y2="285.2578"/><polygon fill="#181818" points="1096.9751,281.2578,1086.9751,285.2578,1096.9751,289.2578,1092.9751,285.2578" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.0186" x="1092.9751" y="267.1919">processMessageWithRetry(msg)</text></g><path d="M1026.6982,300.2578 L1091.1411,300.2578 L1091.1411,307.3906 L1081.1411,317.3906 L1026.6982,317.3906 L1026.6982,300.2578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="248.8672" style="stroke:#000000;stroke-width:1.5;" width="894.2891" x="1026.6982" y="300.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="1041.6982" y="313.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="236.2368" x="1106.1411" y="312.4683">[OperationCreate or OperationDelete]</text><g class="message" data-participant-1="Worker" data-participant-2="Batch"><polygon fill="#181818" points="1433.5059,334.5234,1443.5059,338.5234,1433.5059,342.5234,1437.5059,338.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1085.9751" x2="1439.5059" y1="338.5234" y2="338.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.5308" x="1092.9751" y="333.4575">send batchItem (op,msg) if batch channel available</text></g><g class="message" data-participant-1="Batch" data-participant-2="Batch"><line style="stroke:#181818;stroke-width:1;" x1="1445.5059" x2="1487.5059" y1="367.6563" y2="367.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1487.5059" x2="1487.5059" y1="367.6563" y2="380.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1446.5059" x2="1487.5059" y1="380.6563" y2="380.6563"/><polygon fill="#181818" points="1456.5059,376.6563,1446.5059,380.6563,1456.5059,384.6563,1452.5059,380.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404.7646" x="1452.5059" y="362.5903">accumulate messages until MaxDBBatchSize or BatchTimeout</text></g><g class="message" data-participant-1="Batch" data-participant-2="DB"><polygon fill="#181818" points="1852.2705,405.7891,1862.2705,409.7891,1852.2705,413.7891,1856.2705,409.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1445.5059" x2="1858.2705" y1="409.7891" y2="409.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.1265" x="1452.5059" y="404.7231">batchCreateToDB(batch) / batchDeleteFromDB(batch)</text></g><g class="message" data-participant-1="DB" data-participant-2="Batch"><polygon fill="#181818" points="1456.5059,434.9219,1446.5059,438.9219,1456.5059,442.9219,1452.5059,438.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1450.5059" x2="1863.2705" y1="438.9219" y2="438.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4814" x="1462.5059" y="433.856">success / error</text></g><g class="message" data-participant-1="Batch" data-participant-2="Worker"><polygon fill="#181818" points="1096.9751,464.0547,1086.9751,468.0547,1096.9751,472.0547,1092.9751,468.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1090.9751" x2="1444.5059" y1="468.0547" y2="468.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.438" x="1102.9751" y="462.9888">(batch ack) optional</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1026.6982" x2="1920.9873" y1="477.0547" y2="477.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173.5186" x="1031.6982" y="487.2651">[Other operations (update)]</text><g class="message" data-participant-1="Worker" data-participant-2="DB"><polygon fill="#181818" points="1852.2705,507.9922,1862.2705,511.9922,1852.2705,515.9922,1856.2705,511.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1085.9751" x2="1858.2705" y1="511.9922" y2="511.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.8652" x="1092.9751" y="506.9263">updateUserInDB / createUserInDB / deleteUserFromDB</text></g><g class="message" data-participant-1="DB" data-participant-2="Worker"><polygon fill="#181818" points="1096.9751,537.125,1086.9751,541.125,1096.9751,545.125,1092.9751,541.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1090.9751" x2="1863.2705" y1="541.125" y2="541.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4814" x="1102.9751" y="536.0591">success / error</text></g><g class="message" data-participant-1="Worker" data-participant-2="Jobs"><polygon fill="#181818" points="919.6665,573.2578,909.6665,577.2578,919.6665,581.2578,915.6665,577.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="913.6665" x2="1084.9751" y1="577.2578" y2="577.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.3086" x="925.6665" y="572.1919">send result on job.done</text></g><g class="message" data-participant-1="Jobs" data-participant-2="Fetcher"><polygon fill="#181818" points="730.0435,602.3906,720.0435,606.3906,730.0435,610.3906,726.0435,606.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="724.0435" x2="907.6665" y1="606.3906" y2="606.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.623" x="736.0435" y="601.3247">fetcher receives job.done</text></g><g class="message" data-participant-1="Fetcher" data-participant-2="Commit"><polygon fill="#181818" points="2015.3477,631.5234,2025.3477,635.5234,2015.3477,639.5234,2019.3477,635.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="719.0435" x2="2021.3477" y1="635.5234" y2="635.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.9375" x="726.0435" y="630.4575">commitWithRetry(msg)</text></g><g class="message" data-participant-1="Commit" data-participant-2="Kafka"><polygon fill="#181818" points="599.6875,660.6563,589.6875,664.6563,599.6875,668.6563,595.6875,664.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="593.6875" x2="2026.3477" y1="664.6563" y2="664.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.6484" x="605.6875" y="659.5903">CommitMessages(msg)</text></g><path d="M611.375,679.6563 L675.8179,679.6563 L675.8179,686.7891 L665.8179,696.7891 L611.375,696.7891 L611.375,679.6563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1585.0059" x="611.375" y="679.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="626.375" y="692.7231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107.8892" x="690.8179" y="691.8667">[commit success]</text><path d="M2201.3809,684.6563 L2201.3809,769.6563 L2743.3809,769.6563 L2743.3809,694.6563 L2733.3809,684.6563 L2201.3809,684.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2733.3809,684.6563 L2733.3809,694.6563 L2743.3809,694.6563 L2733.3809,684.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.6553" x="2207.3809" y="701.7231">Key points:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521.3838" x="2207.3809" y="716.856">- Single fetcher and worker pool decouples network IO from processing CPU/DB.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="453.8066" x="2207.3809" y="731.9888">- Batch goroutine reduces DB transactions by grouping create/delete.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="443.9487" x="2207.3809" y="747.1216">- commitWithRetry ensures offsets are not lost on transient failures.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.5757" x="2207.3809" y="762.2544">- Consumer starts a lag monitor to set lagProtected flag when lag high.</text><g class="message" data-participant-1="Commit" data-participant-2="Fetcher"><polygon fill="#181818" points="730.0435,713.9219,720.0435,717.9219,730.0435,721.9219,726.0435,717.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="724.0435" x2="2026.3477" y1="717.9219" y2="717.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.8511" x="736.0435" y="712.856">success</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="611.375" x2="2196.3809" y1="726.9219" y2="726.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.6641" x="616.375" y="737.1323">[commit fail]</text><g class="message" data-participant-1="Commit" data-participant-2="Commit"><line style="stroke:#181818;stroke-width:1;" x1="2027.3477" x2="2069.3477" y1="761.8594" y2="761.8594"/><line style="stroke:#181818;stroke-width:1;" x1="2069.3477" x2="2069.3477" y1="761.8594" y2="774.8594"/><line style="stroke:#181818;stroke-width:1;" x1="2028.3477" x2="2069.3477" y1="774.8594" y2="774.8594"/><polygon fill="#181818" points="2038.3477,770.8594,2028.3477,774.8594,2038.3477,778.8594,2034.3477,774.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.0332" x="2034.3477" y="756.7935">retry logic with backoff</text></g><g class="message" data-participant-1="Commit" data-participant-2="Fetcher"><polygon fill="#181818" points="730.0435,799.9922,720.0435,803.9922,730.0435,807.9922,726.0435,803.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="724.0435" x2="2026.3477" y1="803.9922" y2="803.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.2021" x="736.0435" y="798.9263">final result</text></g><path d="M582,823.9922 L582,908.9922 L1080,908.9922 L1080,833.9922 L1070,823.9922 L582,823.9922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1070,823.9922 L1070,833.9922 L1080,833.9922 L1070,823.9922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.2939" x="588" y="841.0591">Batching details:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="474.0239" x="588" y="856.1919">- Batch items grouped by operation (OperationCreate / OperationDelete)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.2578" x="588" y="871.3247">- MaxDBBatchSize configured in KafkaOptions.MaxDBBatchSize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.6724" x="588" y="886.4575">- BatchTimeout controls max wait before flush</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477.0137" x="588" y="901.5903">DB write functions: batchCreateToDB(batch), batchDeleteFromDB(batch)</text><path d="M5,919.6563 L5,1004.6563 L714,1004.6563 L714,929.6563 L704,919.6563 L5,919.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M704,919.6563 L704,929.6563 L714,929.6563 L704,919.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.0024" x="11" y="936.7231">Kafka message headers expected (examples):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344.1509" x="11" y="951.856">- HeaderOperation: "CREATE" | "UPDATE" | "DELETE"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.6724" x="11" y="966.9888">- HeaderRetryCount: "0"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.1777" x="11" y="982.1216">- HeaderOriginalTimestamp: RFC3339</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.3779" x="11" y="997.2544">Topic names: UserCreateTopic, UserUpdateTopic, UserDeleteTopic, UserRetryTopic, UserDeadLetterTopic</text><!--SRC=[TLLDR-Cu3BtxLn0vEK2RBD3J-h3096vdkpD5YdwWPyMcRMrioP3aIRixyz-7b6Gd3j0UMfUYgCV7foSdNOkmrSeE7Hgeq1KD_Rt-2uxQ7CBNNb2GF_8D_ovqrqa7QL5s_NKdbLmced3Qm3TH7KJI2-Da8NkX72pkOhtqsL4u72DLlLo0i10Nvpl-qNlODa8fR27zL-zjoAMmdIU-1NoFMhS-8_m_pzbuv5-rqOEJ2Y7rhMoRKDElpZTGX-dNtTD3ICWtyzMHfbMWu4swvWcT-V39MnzB4iy2ynJRoyB70rehQaoNoTs9O-ugWyAWS0ZKxF-ThQ-Wr0f_9KfJpCYwSQ2hKx4dFQZoskYzLE1qd99Dk19N32nau_HwMHmiLqxUfd6EARtH1O6AmAPcKi904sqTx7eqmacjjW4WZNWAvTYYmmJevrJP4vg1HLK6qTmxx23L_HNN15b5AHLnlkA7aAtOjw7EPfHPB2EAOkY6ba_k0aOBWtAoXGVndczyrhFyp-Fo_xp83cdGysBv9WkdXYPUTBu9AbZ2EYo4LkwCxgObNuBLVjRKK31Rj0cDqMP-o4Xfs4x83qlGFVCasWHRYx1pF78zqcSX7VgIy2mlA6IuOUNLehbN168T1N8MA3ra3WJOvtX7B9U0QIXd8WZAyvCoQ0UQjbQianMBRrBJfBhH5mmMA7-WFQMUgJdSW0mkRaSGL5ZaD7z1ifWTrMTFgels4k7xpiQzvuZ6TSzkt5EHd6ORJfWC8u5MrxA08o6ZqHS7NLMVrgyapIvouxaxkv39D_o0NalbR9PSmpCv6fdeo94WJiVhH-P4mohqqBT4caB72t2_WuhcDjv0sWxRnzTrlbbHjI2gUl8iW-L0MJnUPuIovBLUGFiFg2cdvzr18EiW2ovoCG90CYxgXPoaikWi28D0_H0Xra_ULvQe0eUSobMcPy6oUzCkQ4KDdLQIxPxSXsfnwD4GDON34YfEE3QeV6P3PAsOF3uB8uCjLjxHeb_xThc74XqTxGaD54Wo3njwfChKxdHx8BsqflMbCosfp8LD55fLigRUIY3lz2hS-JjgL_FC4K7q4zxeZ6ujTE8TZeAKiiTA4uDLEzWceS4S3O65Qb1XDfyvpjNdXlC9IUCJ6HwLQ8FGe2Z9z07V-q1xYk-YOuajcRw__V94I4OFrzFjbvVR1Vo4nUjZFdxcjzzlwNFQuQMofVU5xilYZrDyHwBdsy1ya1AwdbwXk-tDpSsVoOkc5mQKe8KCs8_6dYbyvGEltipE0g7xiu0_TfOWok_e71eVdAZv3G00]--></g></svg>